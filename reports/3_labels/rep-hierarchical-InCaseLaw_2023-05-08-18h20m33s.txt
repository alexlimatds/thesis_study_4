RESULTS REPORT (SINGLE SENTENCE CLASSIFICATION)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: development set (3 random seeds)
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate (encoder): 1e-05
Number of epochs (encoder): 4
Stop epoch (encoder): 2
Embedding dim (encoder): 768
Learning rate (classifier): 0.0003
Number of epochs (classifier): 50
Hidden dim (classifier): 100
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h55m53s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
   1   1.040911  0.042028  0.877702 0.029800   0.3188  0.0474   0.3390  0.0063   0.3015   0.0111
   2   0.940536  0.031140  0.818605 0.023334   0.2796  0.0358   0.3356  0.0033   0.2967   0.0116
   3   0.908046  0.028580  0.796315 0.022364   0.3531  0.0925   0.3351  0.0017   0.2970   0.0101
   4   0.884020  0.027746  0.782889 0.018650   0.4219  0.0716   0.3339  0.0038   0.2991   0.0051
   5   0.865101  0.026150  0.775442 0.020790   0.5160  0.0548   0.3439  0.0040   0.3111   0.0073
   6   0.842457  0.023664  0.755326 0.020183   0.5749  0.0107   0.3436  0.0019   0.3097   0.0037
   7   0.822085  0.021972  0.738328 0.017142   0.5597  0.0227   0.3436  0.0019   0.3100   0.0040
   8   0.801095  0.020952  0.729536 0.012316   0.4883  0.0800   0.3470  0.0041   0.3198   0.0086
   9   0.780266  0.019997  0.720075 0.013585   0.4502  0.0751   0.3507  0.0018   0.3302   0.0045
  10   0.757298  0.019949  0.697270 0.017699   0.4305  0.0388   0.3481  0.0025   0.3242   0.0028
  11   0.734588  0.016656  0.682537 0.009846   0.4391  0.0862   0.3486  0.0011   0.3280   0.0069
  12   0.709849  0.016048  0.677098 0.006069   0.3969  0.0341   0.3549  0.0029   0.3428   0.0102
  13   0.685521  0.016057  0.652759 0.018710   0.3708  0.0093   0.3493  0.0039   0.3354   0.0060
  14   0.661748  0.012368  0.653952 0.010360   0.3823  0.0268   0.3574  0.0026   0.3493   0.0090
  15   0.642678  0.008505  0.642910 0.015465   0.3544  0.0069   0.3497  0.0072   0.3403   0.0132
  16   0.636013  0.006534  0.619544 0.009403   0.3717  0.0282   0.3475  0.0046   0.3332   0.0033
  17   0.627916  0.007773  0.663303 0.040972   0.4891  0.1582   0.3709  0.0238   0.3646   0.0360
  18   0.617829  0.004402  0.647917 0.043317   0.4701  0.1547   0.3594  0.0116   0.3526   0.0217
  19   0.615021  0.002710  0.607898 0.006781   0.4763  0.1468   0.3543  0.0022   0.3466   0.0035
  20   0.609135  0.007398  0.683020 0.063753   0.4822  0.1571   0.3675  0.0253   0.3555   0.0384
  21   0.606527  0.014125  0.707110 0.075787   0.4697  0.1578   0.3703  0.0212   0.3596   0.0269
  22   0.618130  0.015700  0.672682 0.085402   0.4739  0.1412   0.3514  0.0062   0.3362   0.0153
  23   0.600929  0.007871  0.613823 0.027354   0.5104  0.1427   0.3602  0.0190   0.3506   0.0334
  24   0.613701  0.016436  0.683334 0.058598   0.5697  0.0968   0.3748  0.0255   0.3658   0.0464
  25   0.601284  0.009108  0.664835 0.070163   0.5352  0.1309   0.3717  0.0165   0.3685   0.0184
  26   0.600426  0.011529  0.646848 0.052107   0.4796  0.1420   0.3566  0.0139   0.3426   0.0203
  27   0.596568  0.006758  0.611121 0.017087   0.4251  0.0485   0.3634  0.0209   0.3555   0.0381
  28   0.595973  0.005600  0.655247 0.055211   0.5424  0.1110   0.3736  0.0280   0.3707   0.0481
  29   0.589846  0.006327  0.668558 0.065142   0.5293  0.1376   0.3785  0.0176   0.3823   0.0213
  30   0.591249  0.007323  0.647171 0.030635   0.5577  0.1319   0.3664  0.0134   0.3608   0.0147
  31   0.585866  0.002194  0.609465 0.010494   0.4213  0.0713   0.3673  0.0253   0.3657   0.0406
  32   0.586271  0.009992  0.666581 0.050049   0.5183  0.1422   0.3763  0.0269   0.3738   0.0429
  33   0.578093  0.002787  0.681110 0.054868   0.5004  0.1040   0.3919  0.0119   0.3990   0.0187
  34   0.582823  0.012491  0.644916 0.039844   0.5508  0.1391   0.3651  0.0065   0.3628   0.0036
  35   0.577818  0.005888  0.624748 0.020403   0.4165  0.0895   0.3673  0.0358   0.3637   0.0571
  36   0.578474  0.007000  0.691336 0.060832   0.5337  0.1212   0.3841  0.0240   0.3873   0.0378
  37   0.575736  0.008258  0.711198 0.085629   0.5236  0.1328   0.3852  0.0054   0.3862   0.0088
  38   0.576655  0.011409  0.630685 0.003674   0.5540  0.1361   0.3662  0.0082   0.3667   0.0117
  39   0.577116  0.007530  0.629741 0.018131   0.4025  0.0802   0.3630  0.0314   0.3580   0.0509
  40   0.569392  0.007080  0.734379 0.017791   0.5253  0.1313   0.3906  0.0104   0.3954   0.0164
  41   0.571946  0.007405  0.727269 0.091821   0.5954  0.0819   0.3835  0.0094   0.3910   0.0136
  42   0.566636  0.008118  0.625873 0.019653   0.4624  0.1125   0.3604  0.0030   0.3541   0.0072
  43   0.566076  0.003714  0.646448 0.011649   0.4160  0.0729   0.3766  0.0267   0.3790   0.0412
  44   0.566622  0.007970  0.716818 0.017637   0.5254  0.1376   0.3884  0.0204   0.3945   0.0294
  45   0.558278  0.002144  0.694359 0.097877   0.5302  0.1193   0.3737  0.0161   0.3742   0.0286
  46   0.561017  0.011916  0.654210 0.015579   0.4281  0.0879   0.3696  0.0118   0.3703   0.0170
  47   0.563180  0.005800  0.672275 0.030355   0.4178  0.0827   0.3805  0.0293   0.3844   0.0447
  48   0.555915  0.009407  0.706157 0.056866   0.5441  0.1161   0.3889  0.0320   0.3937   0.0453
  49   0.562125  0.009636  0.685109 0.078542   0.5080  0.0928   0.3765  0.0232   0.3823   0.0407
  50   0.553749  0.008322  0.680737 0.043777   0.5370  0.1363   0.3716  0.0069   0.3740   0.0109

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
Other: 2 
=> Iteration 0:
Epoch 50:
[[  41    0  418]
 [   2    5   42]
 [  74    4 1556]]
=> Iteration 1:
Epoch 50:
[[  97    0  362]
 [   8    1   40]
 [ 222    0 1412]]
=> Iteration 2:
Epoch 50:
[[ 139    0  320]
 [   8    0   41]
 [ 323    0 1311]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.041849   0.886690   0.254378   0.331905    0.288016
Iteration 1    0.988975   0.837551   0.367218   0.338033    0.301312
Iteration 2    1.091909   0.908866   0.334711   0.347119    0.315196

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.942004   0.823414   0.254279   0.333333    0.288489
Iteration 1    0.901686   0.787927   0.254361   0.333129    0.288465
Iteration 2    0.977920   0.844473   0.330298   0.340306    0.312999

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.903987   0.791264   0.254279   0.333333    0.288489
Iteration 1    0.875250   0.771801   0.476703   0.334582    0.291427
Iteration 2    0.944902   0.825879   0.328360   0.337401    0.311130

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.877454   0.770377   0.454718   0.335308    0.293005
Iteration 1    0.853801   0.769039   0.488336   0.337805    0.298674
Iteration 2    0.920805   0.809253   0.322529   0.328687    0.305479

Epoch: 5
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.856773   0.759378   0.538983   0.348698    0.320196
Iteration 1    0.838060   0.762149   0.440364   0.338964    0.302428
Iteration 2    0.900470   0.804800   0.568536   0.344023    0.310592

Epoch: 6
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.833681   0.741560   0.572188   0.346201    0.314875
Iteration 1    0.818876   0.740555   0.563368   0.341844    0.306257
Iteration 2    0.874813   0.783863   0.589165   0.342774    0.307847

Epoch: 7
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.812606   0.726656   0.556362   0.345997    0.314722
Iteration 1    0.801198   0.725763   0.533741   0.343615    0.310303
Iteration 2    0.852452   0.762565   0.588925   0.341322    0.304934

Epoch: 8
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.791390   0.717684   0.482112   0.352786    0.330290
Iteration 1    0.781702   0.724409   0.393619   0.344667    0.319946
Iteration 2    0.830193   0.746515   0.589286   0.343500    0.309294

Epoch: 9
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.768559   0.706606   0.414195   0.352884    0.335181
Iteration 1    0.763825   0.714944   0.381624   0.348396    0.331040
Iteration 2    0.808414   0.738675   0.554793   0.350877    0.324333

Epoch: 10
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.746111   0.684446   0.408259   0.347980    0.325427
Iteration 1    0.740462   0.685067   0.398203   0.345075    0.320278
Iteration 2    0.785321   0.722298   0.484980   0.351219    0.326847

Epoch: 11
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.725897   0.676386   0.377988   0.350101    0.335503
Iteration 1    0.719973   0.674793   0.378255   0.347466    0.329674
Iteration 2    0.757894   0.696431   0.561073   0.348176    0.318947

Epoch: 12
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.701562   0.670134   0.375427   0.355829    0.347547
Iteration 1    0.695695   0.676236   0.370333   0.357902    0.352155
Iteration 2    0.732289   0.684924   0.445026   0.350950    0.328660

Epoch: 13
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.679531   0.643995   0.365349   0.347449    0.333007
Iteration 1    0.669546   0.635519   0.363143   0.345768    0.329642
Iteration 2    0.707485   0.678762   0.383836   0.354801    0.343680

Epoch: 14
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.659383   0.668335   0.362232   0.358913    0.355275
Iteration 1    0.647922   0.649173   0.364341   0.359615    0.355974
Iteration 2    0.677939   0.644347   0.420207   0.353814    0.336604

Epoch: 15
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.643085   0.634510   0.344698   0.339689    0.321819
Iteration 1    0.632064   0.629622   0.358446   0.352891    0.346731
Iteration 2    0.652886   0.664597   0.360097   0.356506    0.352258

Epoch: 16
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.644432   0.632120   0.348658   0.343190    0.329905
Iteration 1    0.628506   0.609512   0.355046   0.345434    0.331966
Iteration 2    0.635100   0.617001   0.411444   0.353839    0.337657

Epoch: 17
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.631808   0.672993   0.363636   0.364755    0.362126
Iteration 1    0.617068   0.707932   0.712178   0.402709    0.409981
Iteration 2    0.634874   0.608985   0.391416   0.345303    0.321839

Epoch: 18
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.614249   0.614303   0.364551   0.343108    0.322513
Iteration 1    0.615208   0.620371   0.688729   0.365934    0.373118
Iteration 2    0.624030   0.709077   0.356886   0.369014    0.362074

Epoch: 19
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.616901   0.614172   0.360590   0.351227    0.342533
Iteration 1    0.611189   0.598480   0.683353   0.355563    0.351104
Iteration 2    0.616973   0.611041   0.384866   0.356164    0.346089

Epoch: 20
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.611775   0.701272   0.352931   0.361630    0.357135
Iteration 1    0.599047   0.750357   0.703393   0.400987    0.401708
Iteration 2    0.616583   0.597429   0.390400   0.339739    0.307582

Epoch: 21
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.591233   0.612123   0.351903   0.341411    0.322765
Iteration 1    0.625302   0.797598   0.692685   0.391823    0.386044
Iteration 2    0.603047   0.711609   0.364367   0.377704    0.370048

Epoch: 22
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.617323   0.620262   0.408058   0.343484    0.315301
Iteration 1    0.599317   0.604662   0.670058   0.352193    0.351665
Iteration 2    0.637750   0.793122   0.343484   0.358666    0.341701

Epoch: 23
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.590033   0.652496   0.472938   0.385321    0.394632
Iteration 1    0.604407   0.593653   0.700780   0.355710    0.343558
Iteration 2    0.608348   0.595321   0.357342   0.339428    0.313682

Epoch: 24
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.627292   0.751684   0.482507   0.393143    0.395739
Iteration 1    0.590576   0.689740   0.704765   0.392493    0.401244
Iteration 2    0.623236   0.608578   0.521826   0.338735    0.300272

Epoch: 25
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.588471   0.600261   0.532407   0.356479    0.351127
Iteration 1    0.608826   0.762367   0.696865   0.394687    0.393921
Iteration 2    0.606556   0.631878   0.376351   0.363874    0.360570

Epoch: 26
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.601372   0.613243   0.399649   0.343394    0.316006
Iteration 1    0.585857   0.606856   0.679135   0.350498    0.346612
Iteration 2    0.614051   0.720445   0.360092   0.375811    0.365204

Epoch: 27
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.587012   0.635282   0.493565   0.392570    0.408374
Iteration 1    0.601510   0.598708   0.387896   0.344871    0.320168
Iteration 2    0.601182   0.599373   0.393746   0.352753    0.338049

Epoch: 28
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.596144   0.728701   0.515231   0.409041    0.423903
Iteration 1    0.589031   0.641452   0.689791   0.371213    0.380741
Iteration 2    0.602744   0.595589   0.422107   0.340644    0.307319

Epoch: 29
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.581134   0.610338   0.528022   0.374325    0.382537
Iteration 1    0.592432   0.759499   0.698412   0.401825    0.408139
Iteration 2    0.595971   0.635837   0.361474   0.359370    0.356077

Epoch: 30
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.593636   0.617941   0.615010   0.357546    0.344510
Iteration 1    0.581328   0.634092   0.682730   0.356299    0.357649
Iteration 2    0.598783   0.689480   0.375305   0.385268    0.380188

Epoch: 31
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.583480   0.622775   0.519416   0.402830    0.423045
Iteration 1    0.585341   0.608493   0.352011   0.345711    0.334453
Iteration 2    0.588777   0.597126   0.392543   0.353390    0.339557

Epoch: 32
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.585796   0.716951   0.488724   0.405231    0.418536
Iteration 1    0.574277   0.684461   0.705413   0.383210    0.387111
Iteration 2    0.598739   0.598332   0.360777   0.340473    0.315895

Epoch: 33
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.574636   0.611786   0.509904   0.391328    0.407647
Iteration 1    0.578182   0.745961   0.622853   0.406778    0.416346
Iteration 2    0.581462   0.685582   0.368521   0.377713    0.373051

Epoch: 34
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.581397   0.609526   0.596942   0.360073    0.358779
Iteration 1    0.568288   0.624637   0.693354   0.361057    0.362075
Iteration 2    0.598785   0.700584   0.362060   0.374253    0.367491

Epoch: 35
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.569771   0.652362   0.542913   0.417817    0.443888
Iteration 1    0.579987   0.618190   0.348413   0.343940    0.331731
Iteration 2    0.583695   0.603693   0.358097   0.340065    0.315573

Epoch: 36
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.583969   0.721539   0.507094   0.412588    0.431378
Iteration 1    0.568595   0.745996   0.693629   0.385908    0.391514
Iteration 2    0.582859   0.606474   0.400425   0.353773    0.339035

Epoch: 37
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.564311   0.613579   0.506927   0.385793    0.394451
Iteration 1    0.579350   0.822066   0.693991   0.391538    0.389962
Iteration 2    0.583548   0.697948   0.369906   0.378300    0.374054

Epoch: 38
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.591434   0.630244   0.607095   0.376235    0.375769
Iteration 1    0.563660   0.635389   0.687659   0.366301    0.374218
Iteration 2    0.574871   0.626422   0.367239   0.356155    0.350184

Epoch: 39
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.570895   0.655268   0.515230   0.406951    0.428760
Iteration 1    0.572741   0.619060   0.357068   0.346682    0.333910
Iteration 2    0.587712   0.614894   0.335173   0.335463    0.311332

Epoch: 40
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.578689   0.758782   0.509599   0.405288    0.417476
Iteration 1    0.561525   0.727485   0.693361   0.382652    0.390584
Iteration 2    0.567963   0.716870   0.372976   0.383865    0.378222

Epoch: 41
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.564051   0.622792   0.485990   0.376257    0.386807
Iteration 1    0.569934   0.846292   0.682930   0.377429    0.376835
Iteration 2    0.581852   0.712723   0.617207   0.396807    0.409426

Epoch: 42
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.575816   0.620588   0.619672   0.364129    0.361070
Iteration 1    0.556075   0.652146   0.362992   0.360186    0.356959
Iteration 2    0.568017   0.604884   0.404417   0.356792    0.344174

Epoch: 43
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.560833   0.651286   0.517268   0.408289    0.430278
Iteration 1    0.568965   0.630391   0.348442   0.343075    0.329399
Iteration 2    0.568430   0.657667   0.382259   0.378480    0.377455

Epoch: 44
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.574904   0.738069   0.513672   0.416731    0.434957
Iteration 1    0.555860   0.717504   0.699508   0.379334    0.382516
Iteration 2    0.569100   0.694882   0.362978   0.369218    0.365880

Epoch: 45
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.555749   0.629264   0.511178   0.394334    0.411760
Iteration 1    0.560992   0.832699   0.684845   0.371679    0.368309
Iteration 2    0.558094   0.621116   0.394533   0.355160    0.342539

Epoch: 46
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.576960   0.636230   0.552145   0.385606    0.393740
Iteration 1    0.548318   0.674227   0.358375   0.357624    0.354087
Iteration 2    0.557774   0.652173   0.373923   0.365604    0.363045

Epoch: 47
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.557831   0.664561   0.533980   0.416631    0.443033
Iteration 1    0.560470   0.639561   0.347953   0.344830    0.334585
Iteration 2    0.571240   0.712705   0.371536   0.379957    0.375697

Epoch: 48
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.569209   0.758390   0.528815   0.433486    0.455676
Iteration 1    0.549709   0.732998   0.693320   0.373663    0.376635
Iteration 2    0.548828   0.627084   0.410117   0.359697    0.348675

Epoch: 49
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.555534   0.628928   0.529252   0.403636    0.423690
Iteration 1    0.555091   0.796181   0.609601   0.378796    0.396147
Iteration 2    0.575750   0.630219   0.385198   0.347009    0.327049

Epoch: 50
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.563631   0.626548   0.559269   0.381210    0.389126
Iteration 1    0.543272   0.681903   0.691675   0.365291    0.368615
Iteration 2    0.554343   0.733761   0.359945   0.368386    0.364117

