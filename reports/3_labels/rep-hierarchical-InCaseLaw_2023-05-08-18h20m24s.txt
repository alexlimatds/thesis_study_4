RESULTS REPORT (SINGLE SENTENCE CLASSIFICATION)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: development set (3 random seeds)
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate (encoder): 1e-05
Number of epochs (encoder): 4
Stop epoch (encoder): 2
Embedding dim (encoder): 768
Learning rate (classifier): 0.0002
Number of epochs (classifier): 50
Hidden dim (classifier): 100
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h55m43s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
   1   1.061989  0.043762  0.924513 0.033738   0.3535  0.0386   0.3462  0.0128   0.2890   0.0432
   2   0.972887  0.034751  0.846023 0.025439   0.2907  0.0323   0.3367  0.0051   0.2978   0.0124
   3   0.931233  0.029523  0.817342 0.023038   0.2796  0.0358   0.3355  0.0034   0.2966   0.0116
   4   0.909438  0.029446  0.800450 0.021858   0.3533  0.0924   0.3353  0.0020   0.2972   0.0103
   5   0.892198  0.028253  0.789199 0.019722   0.4271  0.0839   0.3356  0.0011   0.2987   0.0084
   6   0.876935  0.025875  0.782995 0.019966   0.4616  0.0809   0.3379  0.0029   0.2995   0.0047
   7   0.863185  0.025715  0.772701 0.020952   0.5656  0.0165   0.3417  0.0022   0.3058   0.0045
   8   0.847692  0.024376  0.760279 0.019672   0.5683  0.0152   0.3426  0.0015   0.3077   0.0031
   9   0.833742  0.023401  0.750291 0.017462   0.5566  0.0271   0.3441  0.0022   0.3109   0.0046
  10   0.819237  0.023127  0.743677 0.015090   0.5035  0.0694   0.3461  0.0026   0.3169   0.0058
  11   0.804957  0.021171  0.736102 0.015564   0.4682  0.0788   0.3476  0.0030   0.3219   0.0049
  12   0.789054  0.020810  0.723342 0.017515   0.4651  0.0649   0.3485  0.0020   0.3235   0.0020
  13   0.773358  0.020935  0.712170 0.015302   0.4435  0.0747   0.3468  0.0017   0.3222   0.0030
  14   0.757577  0.019164  0.706462 0.011024   0.4281  0.0710   0.3502  0.0023   0.3316   0.0056
  15   0.740869  0.018282  0.695487 0.014309   0.3915  0.0289   0.3492  0.0012   0.3320   0.0020
  16   0.722769  0.017430  0.682334 0.014111   0.3841  0.0266   0.3490  0.0021   0.3331   0.0006
  17   0.703811  0.016728  0.677622 0.005852   0.3834  0.0323   0.3525  0.0025   0.3412   0.0052
  18   0.686599  0.016396  0.665317 0.013367   0.3602  0.0161   0.3486  0.0065   0.3374   0.0089
  19   0.668121  0.014186  0.657849 0.010999   0.3632  0.0122   0.3529  0.0037   0.3456   0.0047
  20   0.650056  0.012370  0.643735 0.009635   0.3660  0.0083   0.3553  0.0027   0.3490   0.0029
  21   0.635502  0.010370  0.643255 0.009473   0.4709  0.1558   0.3558  0.0070   0.3511   0.0131
  22   0.624862  0.007178  0.652975 0.014598   0.4748  0.1471   0.3644  0.0095   0.3631   0.0093
  23   0.617676  0.004653  0.626355 0.007086   0.4681  0.1489   0.3525  0.0091   0.3464   0.0126
  24   0.613659  0.011218  0.656679 0.031581   0.4741  0.1665   0.3662  0.0230   0.3611   0.0360
  25   0.604956  0.003607  0.658205 0.026114   0.4711  0.1461   0.3675  0.0081   0.3671   0.0049
  26   0.609613  0.014703  0.652557 0.054528   0.4706  0.1479   0.3624  0.0081   0.3578   0.0066
  27   0.594717  0.005664  0.669674 0.053925   0.4804  0.1677   0.3779  0.0311   0.3751   0.0421
  28   0.598482  0.010133  0.652539 0.052623   0.5013  0.1493   0.3761  0.0265   0.3716   0.0423
  29   0.589751  0.001624  0.647971 0.036704   0.4749  0.1463   0.3652  0.0115   0.3609   0.0128
  30   0.592836  0.010478  0.632970 0.043488   0.4969  0.1279   0.3619  0.0164   0.3562   0.0207
  31   0.588735  0.006062  0.648109 0.068142   0.4763  0.1576   0.3631  0.0215   0.3555   0.0304
  32   0.587844  0.007985  0.684537 0.048409   0.4721  0.1601   0.3657  0.0188   0.3585   0.0324
  33   0.576809  0.003765  0.621746 0.016421   0.4776  0.1472   0.3576  0.0049   0.3538   0.0038
  34   0.583356  0.007434  0.648025 0.043792   0.5172  0.1222   0.3781  0.0122   0.3845   0.0156
  35   0.574680  0.001292  0.677962 0.052178   0.4525  0.1224   0.3766  0.0225   0.3754   0.0329
  36   0.573290  0.010903  0.618217 0.014603   0.4877  0.1439   0.3555  0.0086   0.3457   0.0188
  37   0.576079  0.001360  0.630627 0.011715   0.4091  0.0546   0.3713  0.0217   0.3723   0.0304
  38   0.577790  0.010479  0.768015 0.018333   0.5076  0.1402   0.3826  0.0131   0.3838   0.0206
  39   0.572708  0.005945  0.674014 0.099262   0.5056  0.0842   0.3877  0.0129   0.3932   0.0135
  40   0.576127  0.008223  0.616428 0.012486   0.5448  0.1150   0.3532  0.0056   0.3435   0.0122
  41   0.569914  0.005898  0.677295 0.075299   0.4176  0.0825   0.3783  0.0293   0.3781   0.0469
  42   0.578290  0.013884  0.747053 0.073044   0.6289  0.0907   0.3853  0.0159   0.3894   0.0253
  43   0.565081  0.001910  0.666882 0.074777   0.5370  0.1222   0.3817  0.0168   0.3871   0.0287
  44   0.572995  0.015329  0.624169 0.013106   0.5183  0.1365   0.3609  0.0181   0.3551   0.0406
  45   0.563087  0.003236  0.671004 0.027367   0.5281  0.1235   0.3829  0.0244   0.3879   0.0352
  46   0.572133  0.012336  0.761678 0.048290   0.5628  0.0473   0.3920  0.0120   0.4013   0.0192
  47   0.561947  0.001751  0.677480 0.084694   0.5300  0.1194   0.3772  0.0067   0.3811   0.0120
  48   0.567205  0.011985  0.628409 0.012615   0.5063  0.1383   0.3541  0.0146   0.3448   0.0343
  49   0.561184  0.005874  0.668805 0.019849   0.5373  0.1233   0.3869  0.0299   0.3925   0.0449
  50   0.566357  0.008437  0.726714 0.046866   0.5286  0.1366   0.3927  0.0274   0.4001   0.0398

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
Other: 2 
=> Iteration 0:
Epoch 50:
[[ 155    1  303]
 [   6    8   35]
 [ 331    7 1296]]
=> Iteration 1:
Epoch 50:
[[ 101    0  358]
 [   9    2   38]
 [ 231    0 1403]]
=> Iteration 2:
Epoch 50:
[[ 180    0  279]
 [   9    0   40]
 [ 444    0 1190]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.060896   0.932095   0.316215   0.329317    0.227976
Iteration 1    1.008946   0.879927   0.337491   0.348841    0.317638
Iteration 2    1.116125   0.961518   0.406644   0.360343    0.321506

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.974327   0.854288   0.254279   0.333333    0.288489
Iteration 1    0.929624   0.811567   0.284957   0.332836    0.289688
Iteration 2    1.014710   0.872213   0.332718   0.343937    0.315323

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0     0.93071   0.821059   0.254279   0.333333    0.288489
Iteration 1     0.89534   0.787451   0.254324   0.332925    0.288365
Iteration 2     0.96765   0.843515   0.330298   0.340306    0.312999

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.906068   0.797145   0.254279   0.333333    0.288489
Iteration 1    0.875178   0.775485   0.476703   0.334582    0.291427
Iteration 2    0.947069   0.828719   0.328844   0.338128    0.311598

Epoch: 5
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.885576   0.779884   0.421184   0.334060    0.290088
Iteration 1    0.861385   0.771088   0.532615   0.336760    0.295939
Iteration 2    0.929633   0.816624   0.327389   0.335949    0.310193

Epoch: 6
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.869941   0.770050   0.537727   0.341118    0.304845
Iteration 1    0.849325   0.767737   0.497547   0.338531    0.300148
Iteration 2    0.911538   0.811199   0.349624   0.334198    0.293428

Epoch: 7
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.854789   0.759220   0.552574   0.344749    0.312055
Iteration 1    0.836739   0.756590   0.555316   0.339665    0.301871
Iteration 2    0.898027   0.802293   0.588806   0.340595    0.303469

Epoch: 8
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.839527   0.748028   0.552574   0.344749    0.312055
Iteration 1    0.822769   0.744774   0.563368   0.341844    0.306257
Iteration 2    0.880779   0.788036   0.588925   0.341322    0.304934

Epoch: 9
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.823377   0.738427   0.558070   0.346723    0.316136
Iteration 1    0.811706   0.737466   0.522714   0.344137    0.311583
Iteration 2    0.866143   0.774980   0.588925   0.341322    0.304934

Epoch: 10
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.809736   0.731181   0.502056   0.349653    0.323313
Iteration 1    0.796884   0.734944   0.419286   0.345140    0.318137
Iteration 2    0.851091   0.764907   0.589286   0.343500    0.309294

Epoch: 11
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.796318   0.722864   0.445186   0.351154    0.328840
Iteration 1    0.784450   0.727493   0.385257   0.343851    0.319284
Iteration 2    0.834102   0.757951   0.574100   0.347654    0.317702

Epoch: 12
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.779419   0.710000   0.442835   0.349702    0.326234
Iteration 1    0.769790   0.711940   0.399070   0.345597    0.321403
Iteration 2    0.817953   0.748087   0.553349   0.350151    0.322955

Epoch: 13
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.762483   0.700965   0.402260   0.347890    0.325993
Iteration 1    0.754948   0.701739   0.379907   0.344398    0.321743
Iteration 2    0.802643   0.733806   0.548355   0.347972    0.318787

Epoch: 14
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.746970   0.698195   0.386940   0.352574    0.338747
Iteration 1    0.741283   0.699150   0.369421   0.346992    0.330756
Iteration 2    0.784479   0.722042   0.528021   0.350991    0.325188

Epoch: 15
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.729392   0.683525   0.375261   0.348853    0.333420
Iteration 1    0.726543   0.687332   0.367024   0.347857    0.333387
Iteration 2    0.766671   0.715603   0.432112   0.350860    0.329227

Epoch: 16
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.712309   0.673814   0.364362   0.347041    0.332634
Iteration 1    0.708669   0.670965   0.366267   0.347971    0.333925
Iteration 2    0.747329   0.702222   0.421674   0.351929    0.332627

Epoch: 17
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.693700   0.677328   0.355824   0.348983    0.340355
Iteration 1    0.690344   0.670606   0.365775   0.354882    0.347969
Iteration 2    0.727389   0.684931   0.428747   0.353586    0.335302

Epoch: 18
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.678370   0.661774   0.341807   0.339967    0.324926
Iteration 1    0.671939   0.651006   0.357937   0.350321    0.341914
Iteration 2    0.709487   0.683170   0.380927   0.355552    0.345421

Epoch: 19
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.664735   0.666242   0.362613   0.356865    0.352124
Iteration 1    0.652690   0.642310   0.348518   0.347881    0.341475
Iteration 2    0.686939   0.664994   0.378403   0.353895    0.343123

Epoch: 20
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.650991   0.646870   0.367589   0.357836    0.352580
Iteration 1    0.634460   0.630684   0.355129   0.351578    0.345568
Iteration 2    0.664718   0.653650   0.375335   0.356466    0.348732

Epoch: 21
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.640646   0.629987   0.358336   0.347115    0.335093
Iteration 1    0.621036   0.648281   0.691302   0.364133    0.367298
Iteration 2    0.644824   0.651496   0.363198   0.356114    0.350950

Epoch: 22
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.631423   0.672909   0.377932   0.377827    0.376200
Iteration 1    0.614874   0.638356   0.682730   0.356299    0.357649
Iteration 2    0.628290   0.647661   0.363750   0.359207    0.355563

Epoch: 23
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.622700   0.634068   0.344641   0.342194    0.329757
Iteration 1    0.611484   0.616957   0.677660   0.350890    0.348974
Iteration 2    0.618843   0.628041   0.382106   0.364413    0.360331

Epoch: 24
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.625772   0.621271   0.347513   0.338980    0.316689
Iteration 1    0.598730   0.697957   0.709352   0.395325    0.404812
Iteration 2    0.616474   0.650809   0.365459   0.364298    0.361821

Epoch: 25
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.606286   0.692064   0.370035   0.378072    0.374004
Iteration 1    0.600026   0.628505   0.677732   0.358353    0.363449
Iteration 2    0.608555   0.654045   0.365563   0.366118    0.363773

Epoch: 26
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.630352   0.729643   0.360833   0.373804    0.366045
Iteration 1    0.600539   0.612198   0.679559   0.356640    0.357553
Iteration 2    0.597947   0.615830   0.371259   0.356718    0.349897

Epoch: 27
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.602134   0.610554   0.352659   0.342480    0.325741
Iteration 1    0.588387   0.740954   0.717282   0.418096    0.428607
Iteration 2    0.593631   0.657513   0.371334   0.373111    0.370979

Epoch: 28
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.608826   0.617310   0.390338   0.343941    0.318653
Iteration 1    0.601899   0.726925   0.712403   0.408875    0.422148
Iteration 2    0.584721   0.613382   0.401129   0.375372    0.374050

Epoch: 29
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.591265   0.635157   0.373373   0.367424    0.365470
Iteration 1    0.590489   0.610817   0.681874   0.350196    0.343499
Iteration 2    0.587498   0.697939   0.369566   0.378096    0.373782

Epoch: 30
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.604483   0.693088   0.434887   0.384997    0.385325
Iteration 1    0.594946   0.614145   0.675046   0.348548    0.344471
Iteration 2    0.579078   0.591676   0.380864   0.352280    0.338842

Epoch: 31
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.581583   0.601963   0.347985   0.341142    0.324085
Iteration 1    0.588217   0.744448   0.698354   0.392264    0.396583
Iteration 2    0.596404   0.597915   0.382604   0.355960    0.345834

Epoch: 32
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.596847   0.619804   0.356804   0.339861    0.315413
Iteration 1    0.589247   0.697608   0.698559   0.384138    0.393706
Iteration 2    0.577439   0.736199   0.361086   0.373004    0.366436

Epoch: 33
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.580764   0.644363   0.356002   0.354172    0.350244
Iteration 1    0.577918   0.615003   0.684726   0.354154    0.352137
Iteration 2    0.571744   0.605872   0.392206   0.364519    0.359094

Epoch: 34
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.593589   0.707791   0.477043   0.395289    0.404694
Iteration 1    0.576155   0.632203   0.682855   0.369472    0.382203
Iteration 2    0.580324   0.604081   0.391775   0.369472    0.366635

Epoch: 35
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.575649   0.604206   0.364613   0.348951    0.336923
Iteration 1    0.572854   0.712887   0.625631   0.403971    0.417291
Iteration 2    0.575538   0.716793   0.367336   0.377011    0.372074

Epoch: 36
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.588656   0.610885   0.377424   0.343353    0.319563
Iteration 1    0.566715   0.638603   0.691034   0.361334    0.363240
Iteration 2    0.564498   0.605163   0.394751   0.361770    0.354297

Epoch: 37
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.576032   0.646233   0.472689   0.389700    0.402166
Iteration 1    0.577768   0.627639   0.339391   0.340839    0.330531
Iteration 2    0.574436   0.618009   0.415255   0.383336    0.384095

Epoch: 38
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.589546   0.746057   0.478798   0.398419    0.405600
Iteration 1    0.564097   0.767053   0.691907   0.383068    0.389646
Iteration 2    0.579726   0.790934   0.352028   0.366443    0.356196

Epoch: 39
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.572514   0.616702   0.480320   0.376537    0.386894
Iteration 1    0.580084   0.813647   0.618972   0.405815    0.411930
Iteration 2    0.565527   0.591694   0.417421   0.380700    0.380642

Epoch: 40
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.579360   0.616449   0.560179   0.360791    0.353905
Iteration 1    0.564836   0.631711   0.677420   0.351347    0.350371
Iteration 2    0.584184   0.601126   0.396885   0.347596    0.326362

Epoch: 41
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.571474   0.625558   0.534201   0.416177    0.441004
Iteration 1    0.576230   0.622557   0.359025   0.344838    0.328324
Iteration 2    0.562038   0.783770   0.359548   0.373763    0.364927

Epoch: 42
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.570428   0.709269   0.501630   0.406063    0.421628
Iteration 1    0.566640   0.682684   0.706005   0.382435    0.386683
Iteration 2    0.597803   0.849205   0.679143   0.367501    0.359821

Epoch: 43
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.564677   0.618137   0.523446   0.399542    0.420134
Iteration 1    0.567596   0.772528   0.693047   0.386503    0.390871
Iteration 2    0.562969   0.609982   0.394534   0.359158    0.350199

Epoch: 44
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.569016   0.612876   0.499471   0.369674    0.375528
Iteration 1    0.556529   0.642543   0.694008   0.377232    0.391400
Iteration 2    0.593439   0.617088   0.361272   0.335675    0.298409

Epoch: 45
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.558936   0.686085   0.522452   0.411414    0.433516
Iteration 1    0.566831   0.632596   0.682069   0.351722    0.347768
Iteration 2    0.563495   0.694331   0.379735   0.385554    0.382434

Epoch: 46
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.575720   0.736311   0.501403   0.406292    0.421479
Iteration 1    0.555553   0.719451   0.616524   0.392735    0.406992
Iteration 2    0.585124   0.829273   0.570502   0.376842    0.375405

Epoch: 47
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.560494   0.629015   0.491169   0.378525    0.389617
Iteration 1    0.564410   0.796570   0.691764   0.384618    0.389527
Iteration 2    0.560938   0.606854   0.407201   0.368420    0.364017

Epoch: 48
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.569407   0.625473   0.498754   0.369038    0.374113
Iteration 1    0.551549   0.645117   0.679218   0.358851    0.363715
Iteration 2    0.580658   0.614638   0.340793   0.334337    0.296612

Epoch: 49
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.554435   0.688250   0.536969   0.424358    0.451082
Iteration 1    0.568753   0.641549   0.688386   0.351053    0.342150
Iteration 2    0.560364   0.676615   0.386459   0.385383    0.384272

Epoch: 50
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.567377   0.709764   0.536062   0.431367    0.455091
Iteration 1    0.555552   0.679699   0.692022   0.373163    0.382764
Iteration 2    0.576144   0.790679   0.357654   0.373477    0.362303

