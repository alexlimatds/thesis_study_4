RESULTS REPORT (SINGLE SENTENCE CLASSIFICATION)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: development set (3 random seeds)
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate (encoder): 1e-05
Number of epochs (encoder): 4
Stop epoch (encoder): 2
Embedding dim (encoder): 768
Learning rate (classifier): 0.0001
Number of epochs (classifier): 50
Hidden dim (classifier): 100
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h55m57s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
   1   1.086074  0.045397  0.989728 0.037377   0.3471  0.0179   0.3539  0.0106   0.2803   0.0414
   2   1.028466  0.040343  0.920360 0.032115   0.3439  0.0482   0.3453  0.0128   0.2890   0.0448
   3   0.986623  0.035239  0.873913 0.027717   0.3073  0.0373   0.3373  0.0048   0.2992   0.0107
   4   0.956866  0.032987  0.845267 0.024825   0.2928  0.0318   0.3366  0.0047   0.2977   0.0121
   5   0.937383  0.031144  0.827591 0.023249   0.2984  0.0323   0.3359  0.0036   0.2973   0.0115
   6   0.922239  0.029169  0.815394 0.022324   0.3167  0.0464   0.3358  0.0032   0.2972   0.0112
   7   0.911442  0.028787  0.806076 0.021520   0.3534  0.0924   0.3356  0.0024   0.2973   0.0105
   8   0.901355  0.028469  0.798996 0.020859   0.4091  0.0608   0.3358  0.0021   0.2979   0.0101
   9   0.892710  0.028082  0.793466 0.020639   0.4015  0.0532   0.3358  0.0017   0.2982   0.0096
  10   0.884451  0.028047  0.788307 0.020799   0.4460  0.0862   0.3367  0.0006   0.3005   0.0075
  11   0.876537  0.026527  0.782874 0.020808   0.4610  0.0947   0.3375  0.0006   0.3024   0.0059
  12   0.868024  0.026199  0.777299 0.020451   0.5098  0.0431   0.3387  0.0013   0.3002   0.0022
  13   0.860192  0.026594  0.771999 0.019826   0.5448  0.0076   0.3408  0.0009   0.3043   0.0018
  14   0.853361  0.025146  0.767196 0.019092   0.5637  0.0227   0.3427  0.0015   0.3081   0.0033
  15   0.845862  0.024293  0.762785 0.018539   0.5436  0.0334   0.3443  0.0015   0.3117   0.0033
  16   0.837769  0.023800  0.758185 0.018288   0.5205  0.0585   0.3445  0.0022   0.3127   0.0041
  17   0.829736  0.023275  0.753225 0.018068   0.4999  0.0578   0.3453  0.0022   0.3150   0.0043
  18   0.823446  0.023616  0.747975 0.017922   0.4926  0.0603   0.3459  0.0019   0.3165   0.0039
  19   0.814694  0.023086  0.742984 0.017717   0.4769  0.0685   0.3460  0.0018   0.3179   0.0046
  20   0.806063  0.021729  0.738336 0.017301   0.4578  0.0725   0.3460  0.0022   0.3192   0.0042
  21   0.797329  0.022605  0.733452 0.016912   0.4440  0.0738   0.3461  0.0019   0.3207   0.0029
  22   0.789230  0.022154  0.728294 0.016625   0.4320  0.0684   0.3465  0.0013   0.3226   0.0022
  23   0.780941  0.021737  0.723286 0.016036   0.4281  0.0648   0.3486  0.0016   0.3274   0.0017
  24   0.772447  0.022230  0.717929 0.015592   0.4142  0.0564   0.3481  0.0019   0.3278   0.0019
  25   0.762759  0.020869  0.712570 0.015358   0.4037  0.0503   0.3482  0.0031   0.3292   0.0029
  26   0.753240  0.020827  0.708343 0.014532   0.3913  0.0395   0.3484  0.0029   0.3313   0.0015
  27   0.744101  0.019888  0.704380 0.013412   0.3833  0.0340   0.3491  0.0026   0.3342   0.0008
  28   0.732771  0.019924  0.697484 0.013886   0.3807  0.0324   0.3494  0.0044   0.3354   0.0035
  29   0.723859  0.019828  0.691716 0.014106   0.3716  0.0232   0.3488  0.0050   0.3354   0.0059
  30   0.712906  0.018482  0.687817 0.013298   0.3641  0.0182   0.3486  0.0053   0.3369   0.0062
  31   0.701592  0.018463  0.681237 0.012742   0.3623  0.0183   0.3491  0.0072   0.3378   0.0108
  32   0.691447  0.017337  0.676221 0.013512   0.3615  0.0159   0.3503  0.0065   0.3410   0.0082
  33   0.680700  0.016578  0.671127 0.012349   0.3655  0.0133   0.3552  0.0046   0.3493   0.0047
  34   0.669371  0.016063  0.661018 0.016315   0.3611  0.0052   0.3523  0.0029   0.3447   0.0050
  35   0.658210  0.016304  0.656354 0.011180   0.3628  0.0072   0.3545  0.0030   0.3484   0.0036
  36   0.645847  0.014208  0.662024 0.014051   0.3567  0.0065   0.3547  0.0071   0.3493   0.0100
  37   0.636111  0.013234  0.643618 0.016190   0.3542  0.0103   0.3496  0.0081   0.3412   0.0117
  38   0.626526  0.010804  0.656426 0.006388   0.4720  0.1578   0.3612  0.0094   0.3595   0.0129
  39   0.618954  0.006971  0.652858 0.010884   0.4749  0.1543   0.3620  0.0073   0.3602   0.0113
  40   0.614443  0.007592  0.639591 0.014028   0.4635  0.1509   0.3532  0.0105   0.3476   0.0145
  41   0.606965  0.005736  0.653375 0.012837   0.4709  0.1484   0.3613  0.0072   0.3597   0.0068
  42   0.601521  0.003454  0.644820 0.002583   0.4743  0.1556   0.3613  0.0121   0.3580   0.0177
  43   0.597997  0.007816  0.649345 0.021148   0.4693  0.1493   0.3577  0.0129   0.3516   0.0184
  44   0.592578  0.003209  0.655188 0.033832   0.4900  0.1512   0.3737  0.0057   0.3739   0.0082
  45   0.593800  0.009398  0.661076 0.018260   0.4751  0.1498   0.3656  0.0078   0.3652   0.0078
  46   0.586644  0.003149  0.652316 0.026775   0.4642  0.1490   0.3557  0.0150   0.3487   0.0197
  47   0.585464  0.008915  0.651477 0.036639   0.4810  0.1605   0.3662  0.0191   0.3603   0.0301
  48   0.582456  0.004219  0.688973 0.028208   0.4811  0.1595   0.3753  0.0130   0.3736   0.0154
  49   0.581169  0.010924  0.655860 0.015873   0.4688  0.1448   0.3615  0.0110   0.3594   0.0112
  50   0.576294  0.002114  0.636206 0.006477   0.4747  0.1428   0.3600  0.0140   0.3556   0.0173

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
Other: 2 
=> Iteration 0:
Epoch 50:
[[  53    0  406]
 [   3    0   46]
 [ 110    0 1524]]
=> Iteration 1:
Epoch 50:
[[  66    0  393]
 [   5    1   43]
 [ 183    0 1451]]
=> Iteration 2:
Epoch 50:
[[ 123    0  336]
 [   5    0   44]
 [ 210    0 1424]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.082596   0.994968   0.326619   0.339346    0.223324
Iteration 1    1.032294   0.941556   0.344367   0.357972    0.320392
Iteration 2    1.143331   1.032660   0.370272   0.364471    0.297219

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.027606   0.927538   0.289121   0.328885    0.225890
Iteration 1    0.979492   0.877933   0.336176   0.346867    0.316503
Iteration 2    1.078299   0.955608   0.406348   0.360042    0.324749

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.985856   0.881930   0.254526   0.332721    0.288417
Iteration 1    0.943853   0.836675   0.334748   0.335128    0.295449
Iteration 2    1.030160   0.903133   0.332667   0.343986    0.313877

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.957056   0.852513   0.254279   0.333333    0.288489
Iteration 1    0.916370   0.811894   0.291764   0.333244    0.289895
Iteration 2    0.997171   0.871394   0.332235   0.343211    0.314859

Epoch: 5
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.935553   0.832456   0.254279   0.333333    0.288489
Iteration 1    0.900187   0.796998   0.310081   0.333448    0.289851
Iteration 2    0.976409   0.853319   0.330782   0.341032    0.313464

Epoch: 6
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.919685   0.816779   0.254279   0.333333    0.288489
Iteration 1    0.887860   0.787386   0.365591   0.333856    0.289984
Iteration 2    0.959171   0.842016   0.330298   0.340306    0.312999

Epoch: 7
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.907214   0.803771   0.254279   0.333333    0.288489
Iteration 1    0.878490   0.780948   0.476703   0.334582    0.291427
Iteration 2    0.948622   0.833510   0.329329   0.338854    0.312065

Epoch: 8
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.896785   0.793488   0.421184   0.334060    0.290088
Iteration 1    0.868999   0.776653   0.476703   0.334582    0.291427
Iteration 2    0.938282   0.826848   0.329329   0.338854    0.312065

Epoch: 9
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.885480   0.785501   0.421184   0.334060    0.290088
Iteration 1    0.862507   0.773130   0.454562   0.335104    0.292828
Iteration 2    0.930143   0.821766   0.328844   0.338128    0.311598

Epoch: 10
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.878096   0.778731   0.477060   0.336034    0.294506
Iteration 1    0.853721   0.769009   0.532615   0.336760    0.295939
Iteration 2    0.921535   0.817181   0.328360   0.337401    0.311130

Epoch: 11
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.870920   0.772474   0.514455   0.338213    0.298972
Iteration 1    0.847222   0.764234   0.540671   0.337487    0.297431
Iteration 2    0.911467   0.811915   0.327875   0.336675    0.310662

Epoch: 12
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.861249   0.766603   0.533333   0.340391    0.303386
Iteration 1    0.839866   0.759374   0.546743   0.338213    0.298917
Iteration 2    0.902957   0.805918   0.449374   0.337397    0.298431

Epoch: 13
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.852277   0.761071   0.541510   0.341844    0.306298
Iteration 1    0.832309   0.755100   0.537570   0.340914    0.304668
Iteration 2    0.895991   0.799824   0.555316   0.339665    0.301871

Epoch: 14
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.845870   0.755901   0.568536   0.344023    0.310592
Iteration 1    0.827000   0.751604   0.533741   0.343615    0.310303
Iteration 2    0.887212   0.794082   0.588806   0.340595    0.303469

Epoch: 15
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.837666   0.751045   0.531773   0.346315    0.315826
Iteration 1    0.821066   0.748354   0.509980   0.343933    0.311437
Iteration 2    0.878853   0.788957   0.589165   0.342774    0.307847

Epoch: 16
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.829256   0.745983   0.525847   0.347564    0.318466
Iteration 1    0.813824   0.744538   0.446231   0.342505    0.310412
Iteration 2    0.870226   0.784035   0.589286   0.343500    0.309294

Epoch: 17
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.820537   0.740651   0.504062   0.348404    0.320745
Iteration 1    0.806967   0.740249   0.427070   0.343459    0.313672
Iteration 2    0.861706   0.778775   0.568536   0.344023    0.310592

Epoch: 18
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.814073   0.735215   0.485335   0.348519    0.321616
Iteration 1    0.800372   0.735389   0.422698   0.344300    0.315928
Iteration 2    0.855894   0.773321   0.569882   0.344749    0.312025

Epoch: 19
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.805141   0.730142   0.453722   0.348543    0.323134
Iteration 1    0.792433   0.730773   0.407047   0.344847    0.318653
Iteration 2    0.846507   0.768037   0.569882   0.344749    0.312025

Epoch: 20
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.795386   0.725760   0.433002   0.348771    0.324756
Iteration 1    0.786447   0.726448   0.384023   0.343329    0.318162
Iteration 2    0.836355   0.762799   0.556362   0.345997    0.314722

Epoch: 21
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.785581   0.721173   0.410133   0.347662    0.324496
Iteration 1    0.777455   0.721816   0.375472   0.343467    0.320321
Iteration 2    0.828952   0.757366   0.546423   0.347246    0.317386

Epoch: 22
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.777811   0.716013   0.390620   0.345826    0.322946
Iteration 1    0.769671   0.717072   0.377014   0.345467    0.325120
Iteration 2    0.820206   0.751797   0.528343   0.348290    0.319856

Epoch: 23
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.768319   0.711452   0.384828   0.347531    0.328087
Iteration 1    0.762977   0.712448   0.379781   0.347351    0.329038
Iteration 2    0.811527   0.745957   0.519778   0.350787    0.325016

Epoch: 24
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.759864   0.706962   0.372840   0.346013    0.327304
Iteration 1    0.753788   0.706845   0.375865   0.347580    0.330294
Iteration 2    0.803688   0.739979   0.493971   0.350697    0.325677

Epoch: 25
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.749017   0.702935   0.364140   0.344381    0.325871
Iteration 1    0.747009   0.700530   0.372281   0.348241    0.332851
Iteration 2    0.792249   0.734244   0.474707   0.351856    0.328791

Epoch: 26
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.740561   0.700121   0.360620   0.345271    0.329663
Iteration 1    0.736556   0.696144   0.366181   0.347653    0.333197
Iteration 2    0.782602   0.728766   0.447013   0.352199    0.331060

Epoch: 27
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.731795   0.698071   0.358054   0.346682    0.333924
Iteration 1    0.728351   0.692042   0.360461   0.347816    0.335368
Iteration 2    0.772156   0.723025   0.431350   0.352745    0.333378

Epoch: 28
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.719805   0.690903   0.356734   0.345001    0.330750
Iteration 1    0.717591   0.684751   0.358891   0.347841    0.336127
Iteration 2    0.760919   0.716797   0.426567   0.355470    0.339232

Epoch: 29
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.711525   0.687599   0.349688   0.342415    0.327093
Iteration 1    0.708218   0.676871   0.361372   0.349407    0.338669
Iteration 2    0.751835   0.710679   0.403764   0.354703    0.340399

Epoch: 30
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.701770   0.685664   0.346347   0.342055    0.328474
Iteration 1    0.697996   0.672713   0.356843   0.348730    0.338946
Iteration 2    0.738952   0.705073   0.389190   0.354981    0.343144

Epoch: 31
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.691024   0.675829   0.342406   0.339306    0.322490
Iteration 1    0.686198   0.669054   0.357950   0.351504    0.344302
Iteration 2    0.727554   0.698827   0.386653   0.356572    0.346506

Epoch: 32
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.682414   0.676266   0.346113   0.342512    0.330422
Iteration 1    0.676224   0.659650   0.355124   0.349848    0.342183
Iteration 2    0.715704   0.692747   0.383339   0.358391    0.350480

Epoch: 33
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.673416   0.670262   0.362738   0.355910    0.350736
Iteration 1    0.665043   0.656454   0.350763   0.349219    0.342999
Iteration 2    0.703641   0.686664   0.383069   0.360505    0.354179

Epoch: 34
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.665238   0.650072   0.362813   0.349293    0.338247
Iteration 1    0.652091   0.648900   0.354093   0.351284    0.345441
Iteration 2    0.690782   0.684081   0.366460   0.356270    0.350464

Epoch: 35
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.656335   0.650476   0.364035   0.352998    0.345128
Iteration 1    0.639245   0.646581   0.353390   0.351741    0.346532
Iteration 2    0.679050   0.672004   0.370967   0.358742    0.353403

Epoch: 36
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.645880   0.653411   0.347971   0.345058    0.335411
Iteration 1    0.628430   0.650821   0.358765   0.357191    0.353538
Iteration 2    0.663233   0.681839   0.363459   0.361777    0.358896

Epoch: 37
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.637730   0.647970   0.347882   0.343100    0.330212
Iteration 1    0.619154   0.621976   0.345971   0.344789    0.335979
Iteration 2    0.651449   0.660909   0.368713   0.361018    0.357334

Epoch: 38
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.630043   0.654649   0.349252   0.347971    0.341390
Iteration 1    0.611891   0.649644   0.694798   0.367038    0.370622
Iteration 2    0.637645   0.664985   0.371837   0.368517    0.366577

Epoch: 39
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.621995   0.640495   0.358750   0.351708    0.344527
Iteration 1    0.609312   0.666980   0.692950   0.367315    0.371067
Iteration 2    0.625554   0.651099   0.373042   0.367106    0.364930

Epoch: 40
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.620447   0.638389   0.344641   0.342194    0.329757
Iteration 1    0.603733   0.623042   0.676477   0.350164    0.348020
Iteration 2    0.619149   0.657341   0.369391   0.367293    0.365160

Epoch: 41
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.612524   0.659501   0.361235   0.358415    0.354874
Iteration 1    0.599070   0.635513   0.680647   0.354300    0.354858
Iteration 2    0.609299   0.665112   0.370739   0.371316    0.369306

Epoch: 42
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.605422   0.641662   0.351213   0.344871    0.332969
Iteration 1    0.597024   0.644812   0.693833   0.365561    0.368829
Iteration 2    0.602116   0.647988   0.377706   0.373486    0.372091

Epoch: 43
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.607675   0.635633   0.356431   0.344022    0.327596
Iteration 1    0.588534   0.633183   0.680195   0.354211    0.354934
Iteration 2    0.597783   0.679220   0.371164   0.374930    0.372395

Epoch: 44
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.596499   0.672507   0.366079   0.365775    0.363462
Iteration 1    0.588639   0.685155   0.702912   0.379212    0.383398
Iteration 2    0.592595   0.607903   0.400993   0.376008    0.374977

Epoch: 45
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.606573   0.685791   0.356649   0.359884    0.357106
Iteration 1    0.584233   0.655203   0.686483   0.360298    0.362886
Iteration 2    0.590595   0.642235   0.382114   0.376685    0.375692

Epoch: 46
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.590173   0.636168   0.347002   0.341370    0.325253
Iteration 1    0.582528   0.630729   0.674440   0.349258    0.347411
Iteration 2    0.587232   0.690052   0.371097   0.376432    0.373445

Epoch: 47
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.597915   0.634890   0.347919   0.339616    0.318443
Iteration 1    0.577520   0.702283   0.706750   0.383797    0.387906
Iteration 2    0.580958   0.617259   0.388373   0.375314    0.374427

Epoch: 48
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.587561   0.649982   0.362211   0.357004    0.352804
Iteration 1    0.582580   0.715771   0.706491   0.386368    0.389546
Iteration 2    0.577228   0.701165   0.374596   0.382519    0.378499

Epoch: 49
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.596500   0.676826   0.356664   0.360634    0.357787
Iteration 1    0.571847   0.638431   0.673280   0.348532    0.346466
Iteration 2    0.575161   0.652324   0.376471   0.375420    0.373827

Epoch: 50
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.577592   0.627606   0.363511   0.349383    0.337974
Iteration 1    0.573314   0.643234   0.676263   0.350735    0.349777
Iteration 2    0.577977   0.637778   0.384421   0.379818    0.379015

